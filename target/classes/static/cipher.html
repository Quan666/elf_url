<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>密语</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta http-equiv="Access-Control-Allow-Origin" content="*">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <link rel="icon" href="images/favicon.ico">
    <link rel="stylesheet" href="lib/layui-v2.5.5/css/layui.css" media="all">
    <link rel="stylesheet" href="css/layuimini.css?v=2.0.0" media="all">
    <link rel="stylesheet" href="lib/font-awesome-4.7.0/css/font-awesome.min.css" media="all">
    <!--[if lt IE 9]>
    <script src="https://cdn.staticfile.org/html5shiv/r29/html5.min.js"></script>
    <script src="https://cdn.staticfile.org/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
    <style id="layuimini-bg-color">
    </style>
</head>
<body>
<fieldset class="layui-elem-field layui-field-title" style="margin-top: 20px;">
    <legend>密语</legend>
</fieldset>

<div style="padding: 20px; background-color: #F2F2F2;">
    <div class="layui-row layui-col-space15">
        <div class="layui-col-md12">
            <div class="layui-card">
                <div class="layui-card-header">这是一条密语</div>
                <div class="layui-card-body" id="CipherMessage">
                    内容获取失败！
                </div>
            </div>
        </div>
    </div>
</div>
<script src="js/Ajax.js"></script>
<script src="lib/layui-v2.5.5/layui.js" charset="utf-8"></script>
<script src="js/lay-config.js?v=2.0.0" charset="utf-8"></script>
<script>
    layui.use('layer', function() {
        layer.prompt({
            formType: 1,
            value: '',
            title: '请输密码'
        }, function (value, index, elem) {

            var obj = {};
            obj.code = getQueryVariable("code");
            obj.passwd = value;
            AjaxPostLoadXML('/cipher/selectByKey', obj, showMessage);
            layer.close(index);
        });

        function showMessage(object) {
            if (object.code == -1) {
                layer.msg('密码错误！');
                document.getElementById("CipherMessage").innerText = object.data.message;
            } else if (object.code == 0) {
                layer.msg('不存在！');
                document.getElementById("CipherMessage").innerText = object.data;
            } else if (object.code > 0) {
                document.getElementById("CipherMessage").innerText = object.data.message;
            }

        }

        function getQueryVariable(variable) {
            var query = window.location.search.substring(1);
            var vars = query.split("&");
            for (var i = 0; i < vars.length; i++) {
                var pair = vars[i].split("=");
                if (pair[0] === variable) {
                    return pair[1];
                }
            }
            return (false);
        }
    });
</script>
</body>
</html>